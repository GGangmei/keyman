c start_of_sentence_3621 generated from template at 2021-11-22 15:39:24
c with name "start_of_sentence_3621"
store(&VERSION) '10.0'
store(&NAME) 'start_of_sentence_3621'
store(&COPYRIGHT) '©'
store(&KEYBOARDVERSION) '1.0'
store(&TARGETS) 'any'
store(&VISUALKEYBOARD) 'start_of_sentence_3621.kvks'
store(&LAYOUTFILE) 'start_of_sentence_3621.keyman-touch-layout'

begin Unicode > use(main)
begin NewContext > use(NewContext)
begin PostKeystroke > use(PostKeystroke)

group(NewContext)
    nomatch > use(nextLayer)

group(PostKeystroke)

store(caps) 'A'..'Z'
store(digit) '0'..'9'

    c until we get a 'CAPS' layer, stay on CAPS if 2+ chrs in caps
    if(&layerChanged = "0") any(caps) any(caps) > context

    c stay on the numeric layer if we are there already
    if(&layerChanged = "0") if(&layer = 'numeric') any(digit) > context

    c no other changes, so detect sentence or layer change
    if(&layerChanged = "0") > use(nextLayer)

group(nextLayer)

    store(sentencePunctuation) '.?!'
    nul > layer('shift')
    any(sentencePunctuation) ' ' > context layer('shift')
    any(sentencePunctuation) '  ' > context layer('shift')
    nomatch > layer('default')

group(main) using keys

